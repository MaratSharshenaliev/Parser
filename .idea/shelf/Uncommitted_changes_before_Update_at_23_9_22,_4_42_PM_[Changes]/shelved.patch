Index: main.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>from bs4 import BeautifulSoup as BS\nimport requests\nimport dateparser\nfrom typing import List, Dict\nimport csv\nfrom model import Data\nimport datetime\n\nheaders = {\n    \"Accept\": \"*/*\",\n    \"User-Agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.0.0 Safari/537.36\"\n\n}\n\n\ndef saveTocsv(data: Dict) -> int:\n    with open(\"data.csv\", \"a\") as file:\n        writer = csv.writer(file)\n        writer.writerow((data['link_of_photo'], data['date_posted'], data['price']))\n\n    return 0\n\n\ndef getData() -> int:\n    global somethingI\n    for i in range(1, 94):\n        BASE_URL = f\"https://www.kijiji.ca/b-apartments-condos/city-of-toronto/page-{i}/c37l1700273\"\n        res = requests.get(BASE_URL, headers)\n        soup = BS(res.content, 'html.parser')\n        for photo, date_posted, price in zip(soup.select(\".image > picture > source\"),\n                                             soup.select(\".location > .date-posted\"),\n                                             soup.select(\".info-container > .price\")):\n            # filters\n            photo = photo.get(\"data-srcset\").replace(\"200-webp\", \"640-webp\")\n            date_posted = date_posted.text.strip()\n            price = price.text.strip()\n\n            # normalize dates\n            if date_posted not in \"/\":\n                dt = dateparser.parse(date_posted.replace(\"<\", \"\"))\n                date_posted = dt.strftime(\"%d/%m/%Y\")\n\n            data = {\n                \"link_of_photo\": photo,\n                \"date_posted\": date_posted,\n                \"price\": price\n            }\n            somethingI = saveTocsv(data)\n        print(f\"[INFO] Обработано - {i} страницы\")\n    return 0 if somethingI == 0 else 1\n\n\ndef save_database(data: str):\n    link_of_photo = data[\"link_of_photo\"]\n    readyDate = [int(i) for i in data[\"date_posted\"].split(\"/\")][::-1]\n    date_posted = datetime.date(readyDate[0], readyDate[1], readyDate[2])\n    price = float(data[\"price\"].replace(\",\", \"\")[1:]) if data[\"price\"] != \"Please Contact\" else 0\n\n    if len(str(price)) > 7:\n        price = str(price)[:-3]\n\n    print(link_of_photo, date_posted, price)\n    # Data(\n    #     link_of_photo=link_of_photo,\n    #     date_posted=date_posted,\n    #     price=price\n    # ).save()\n\n\ndef save():\n    with open(\"data.csv\") as f:\n        keys = [\"link_of_photo\", \"date_posted\", \"price\"]\n        reader_baike = csv.DictReader(f, fieldnames=keys)\n        data = list(reader_baike)\n\n        for pack in data:\n            save_database(pack)\n\n\nif __name__ == '__main__':\n    somethingO = getData()\n    if somethingO == 0:\n        save()\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/main.py b/main.py
--- a/main.py	(revision f599545856016d123187dfb1e6a5cadde5c6c719)
+++ b/main.py	(date 1663929350861)
@@ -22,8 +22,9 @@
 
 
 def getData() -> int:
+    print("Parser has been started...")
     global somethingI
-    for i in range(1, 94):
+    for i in range(1, 2):
         BASE_URL = f"https://www.kijiji.ca/b-apartments-condos/city-of-toronto/page-{i}/c37l1700273"
         res = requests.get(BASE_URL, headers)
         soup = BS(res.content, 'html.parser')
@@ -46,7 +47,7 @@
                 "price": price
             }
             somethingI = saveTocsv(data)
-        print(f"[INFO] Обработано - {i} страницы")
+        print(f"[Parsing] Parsed - {i} pages...[OK]")
     return 0 if somethingI == 0 else 1
 
 
@@ -59,12 +60,11 @@
     if len(str(price)) > 7:
         price = str(price)[:-3]
 
-    print(link_of_photo, date_posted, price)
-    # Data(
-    #     link_of_photo=link_of_photo,
-    #     date_posted=date_posted,
-    #     price=price
-    # ).save()
+    Data(
+        link_of_photo=link_of_photo,
+        date_posted=date_posted,
+        price=price
+    ).save()
 
 
 def save():
@@ -77,7 +77,18 @@
             save_database(pack)
 
 
+# Here not much game to start 😂😂
+def isRun(prompt):
+    while True:
+        try:
+            return {"Y": True, "y": True, "N": False, "n": False}[input(prompt).lower()]
+        except KeyError:
+            print("Invalid input, please enter Y or N!")
+
+
 if __name__ == '__main__':
-    somethingO = getData()
+
+    somethingO = getData() if isRun("Run will be parsing? Yes - Y/N - No: ") else 1
     if somethingO == 0:
-        save()
+        if isRun("Datas has downloaded.Save anywere? Yes - Y/N - No: "):
+            save()
Index: data.csv
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/data.csv b/data.csv
new file mode 100644
--- /dev/null	(date 1663929431029)
+++ b/data.csv	(date 1663929431029)
@@ -0,0 +1,43 @@
+https://media.kijiji.ca/api/v1/ca-prod-fsbo-ads/images/77/77fe8756-e969-4faa-bed5-753b6f8c88ee?rule=kijijica-640-webp,20/09/2022,"$1,880.00"
+https://media.kijiji.ca/api/v1/ca-prod-dealer-ads/images/aa/aa81a722-016f-41c6-b28b-51620d46ac01?rule=kijijica-640-webp,09/10/2022,"$3,349.00"
+https://media.kijiji.ca/api/v1/ca-prod-dealer-ads/images/b7/b7055f9f-39ec-486c-8aa4-44bf8a34b184?rule=kijijica-640-webp,23/09/2022,"$2,399.00"
+https://media.kijiji.ca/api/v1/ca-prod-dealer-ads/images/c9/c986474a-d21d-4e04-b689-f3588520f952?rule=kijijica-640-webp,31/08/2022,"$1,899.00"
+https://media.kijiji.ca/api/v1/ca-prod-dealer-ads/images/4a/4aaa5284-68eb-49a1-87c0-da9b2c2b2484?rule=kijijica-640-webp,25/08/2022,"$2,150.00"
+https://media.kijiji.ca/api/v1/ca-prod-dealer-ads/images/60/6066cf10-7cfd-466f-a3aa-32927ef332c4?rule=kijijica-640-webp,23/09/2022,"$8,995.00"
+https://media.kijiji.ca/api/v1/ca-prod-dealer-ads/images/54/5445449f-e14c-4187-9d64-c30aa3a45f8f?rule=kijijica-640-webp,23/09/2022,"$3,384.00"
+https://media.kijiji.ca/api/v1/ca-prod-dealer-ads/images/02/02d7065f-7b8d-4139-8da7-2ae66fce2b8d?rule=kijijica-640-webp,23/09/2022,"$2,550.00"
+https://media.kijiji.ca/api/v1/ca-prod-dealer-ads/images/a0/a09352ae-b20e-4c82-8b05-9629a54bdd00?rule=kijijica-640-webp,23/09/2022,"$2,050.00"
+https://media.kijiji.ca/api/v1/ca-prod-fsbo-ads/images/c6/c6166796-b76c-480f-9c18-0077bbbc393d?rule=kijijica-640-webp,23/09/2022,"$2,000.00"
+https://media.kijiji.ca/api/v1/ca-prod-dealer-ads/images/9e/9eccd61b-774f-4ae4-9632-bec0bb4b4dbc?rule=kijijica-640-webp,23/09/2022,"$1,900.00"
+https://media.kijiji.ca/api/v1/ca-prod-dealer-ads/images/46/4621e461-9777-4c02-8681-08bdcd42703f?rule=kijijica-640-webp,23/09/2022,"$9,999.00"
+https://media.kijiji.ca/api/v1/ca-prod-dealer-ads/images/2e/2ec08aba-378e-403b-83d2-18108e208075?rule=kijijica-640-webp,23/09/2022,"$2,000.00"
+https://media.kijiji.ca/api/v1/ca-prod-dealer-ads/images/b8/b8222768-6f26-4e60-be2f-5c992b9ca427?rule=kijijica-640-webp,23/09/2022,"$1,900.00"
+https://media.kijiji.ca/api/v1/ca-prod-dealer-ads/images/8d/8de997c0-e49a-4bf6-ab97-b21e804256b1?rule=kijijica-640-webp,23/09/2022,"$3,100.00"
+https://media.kijiji.ca/api/v1/ca-prod-dealer-ads/images/ca/caa87d76-48c7-479f-bb45-1f064ebdbaff?rule=kijijica-640-webp,23/09/2022,"$1,950.00"
+https://media.kijiji.ca/api/v1/ca-prod-dealer-ads/images/cb/cbb91b73-89b1-44ea-9cf5-22b3a2f02e72?rule=kijijica-640-webp,23/09/2022,"$2,650.00"
+https://media.kijiji.ca/api/v1/ca-prod-fsbo-ads/images/a7/a7f9a1f0-881f-455c-84ec-395cbb009f8e?rule=kijijica-640-webp,23/09/2022,"$5,800.00"
+https://media.kijiji.ca/api/v1/ca-prod-fsbo-ads/images/1e/1e339642-d758-4b64-9804-443d6f1dcca6?rule=kijijica-640-webp,23/09/2022,"$3,800.00"
+https://media.kijiji.ca/api/v1/ca-prod-fsbo-ads/images/61/6172b28b-bc13-4426-b216-d19d106f2af0?rule=kijijica-640-webp,23/09/2022,"$3,000.00"
+https://media.kijiji.ca/api/v1/ca-prod-fsbo-ads/images/0c/0c92718b-4724-46a9-aaae-d55e17529499?rule=kijijica-640-webp,23/09/2022,"$3,995.00"
+https://media.kijiji.ca/api/v1/ca-prod-fsbo-ads/images/08/0843de96-2320-4dc0-9dbe-8725cc384724?rule=kijijica-640-webp,23/09/2022,"$3,200.00"
+https://media.kijiji.ca/api/v1/ca-prod-dealer-ads/images/ed/ed213a9c-f346-4a34-bd59-08ba23f5f490?rule=kijijica-640-webp,23/09/2022,Please Contact
+https://media.kijiji.ca/api/v1/ca-prod-fsbo-ads/images/45/451d5cea-0710-4d82-838e-ad89fa1c9f20?rule=kijijica-640-webp,23/09/2022,"$2,600.00"
+https://media.kijiji.ca/api/v1/ca-prod-dealer-ads/images/ba/ba7ff7bc-5234-42b0-b11a-d22606a4c907?rule=kijijica-640-webp,23/09/2022,"$2,151.00"
+https://media.kijiji.ca/api/v1/ca-prod-dealer-ads/images/8e/8e3e4e55-83e1-4e03-b2f9-89c86b0bdcb9?rule=kijijica-640-webp,23/09/2022,"$2,109.00"
+https://media.kijiji.ca/api/v1/ca-prod-dealer-ads/images/fb/fb80e42e-8244-4f82-9324-c419dac036dc?rule=kijijica-640-webp,23/09/2022,"$1,734.00"
+https://media.kijiji.ca/api/v1/ca-prod-dealer-ads/images/83/836a5fd7-2009-44b1-9d16-a71233773480?rule=kijijica-640-webp,23/09/2022,"$2,127.00"
+https://media.kijiji.ca/api/v1/ca-prod-dealer-ads/images/4b/4b047e61-f536-4050-a23f-52b5e6af4eec?rule=kijijica-640-webp,23/09/2022,"$2,768.00"
+https://media.kijiji.ca/api/v1/ca-prod-dealer-ads/images/8a/8a125587-96a7-4e22-8e28-3012ee68dd13?rule=kijijica-640-webp,23/09/2022,"$2,044.00"
+https://media.kijiji.ca/api/v1/ca-prod-dealer-ads/images/7c/7c429334-54ab-4115-a6a6-129b335af7b3?rule=kijijica-640-webp,23/09/2022,"$1,879.00"
+https://media.kijiji.ca/api/v1/ca-prod-dealer-ads/images/f5/f5dd4690-826c-4f65-bba0-ea782f357cfd?rule=kijijica-640-webp,23/09/2022,"$1,644.00"
+https://media.kijiji.ca/api/v1/ca-prod-dealer-ads/images/17/178cbdd3-3bc0-4542-81af-911a4770957f?rule=kijijica-640-webp,23/09/2022,"$2,832.00"
+https://media.kijiji.ca/api/v1/ca-prod-dealer-ads/images/75/7564263b-d56a-44d5-bdf4-4c470ded5cd8?rule=kijijica-640-webp,23/09/2022,"$1,734.00"
+https://media.kijiji.ca/api/v1/ca-prod-fsbo-ads/images/75/75503065-86d1-48a2-898c-be63f05b952f?rule=kijijica-640-webp,23/09/2022,"$2,200.00"
+https://media.kijiji.ca/api/v1/ca-prod-fsbo-ads/images/e0/e02fb477-0f94-472f-b76a-9eac53760450?rule=kijijica-640-webp,23/09/2022,"$3,150.00"
+https://media.kijiji.ca/api/v1/ca-prod-dealer-ads/images/72/7296f42f-22fc-4d0e-a49f-cd8c57a7e399?rule=kijijica-640-webp,23/09/2022,"$1,695.00"
+https://media.kijiji.ca/api/v1/ca-prod-fsbo-ads/images/23/2344af52-cd5f-4c76-9584-bf4c79569162?rule=kijijica-640-webp,23/09/2022,"$1,000.00"
+https://media.kijiji.ca/api/v1/ca-prod-fsbo-ads/images/c7/c70b436b-c4ab-4c03-9668-dac5a5ff8190?rule=kijijica-640-webp,23/09/2022,"$1,000.00"
+https://media.kijiji.ca/api/v1/ca-prod-fsbo-ads/images/11/11b316ba-aa1c-48ab-baa5-9ee8bb373eef?rule=kijijica-640-webp,23/09/2022,"$3,000.00"
+https://media.kijiji.ca/api/v1/ca-prod-fsbo-ads/images/37/37fe011b-7734-4ab6-aff9-2ebb100afb79?rule=kijijica-640-webp,23/09/2022,"$2,600.00"
+https://media.kijiji.ca/api/v1/ca-prod-fsbo-ads/images/0d/0dddd015-23fe-4e51-8902-8dac3be27ca1?rule=kijijica-640-webp,23/09/2022,"$2,350.00"
+https://media.kijiji.ca/api/v1/ca-prod-fsbo-ads/images/c7/c7f197a5-c538-4786-bc20-a24d8dfae055?rule=kijijica-640-webp,23/09/2022,"$2,795.00"
Index: .gitignore
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>/venv/
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.gitignore b/.gitignore
--- a/.gitignore	(revision f599545856016d123187dfb1e6a5cadde5c6c719)
+++ b/.gitignore	(date 1663878865214)
@@ -1,1 +1,2 @@
-/venv/
\ No newline at end of file
+/venv/
+.idea
\ No newline at end of file
